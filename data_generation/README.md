# Data generation scripts
These scripts extend an original dataset csv with certain data generation methods.

## Invert templates
This method inverts certain templates by swapping the first and second word, which also 'swaps' the label from a 1 to a 0 (and vice-versa) where possible. This is done in order to hopefully make sure the model does not learn specific word orders or templates, but instead the task at hand.

## New words
This method adds new words to existing templates in order to expand the 'vocabulary' of the model. This hopefully improves the model's ability to generalize and do well on the large unseen test set.

## Pegasus
This method puts sentences through a paraphrase model ([https://huggingface.co/tuner007/pegasus_paraphrase](https://huggingface.co/tuner007/pegasus_paraphrase)) in order to add sentence variation so the model hopefully does not learn specific templates, but instead the content of the sentence and the corresponding label, regardless of the form.

# Usage
All models take in a csv with sentences and output an expanded csv. This is done to support interoperability between data generation scripts and model training methods.

```
  -i INPUT_PATH, --input_path INPUT_PATH
                        (English) CSV with templates to expand.
  -o OUTPUT_PATH, --output_path OUTPUT_PATH
                        Output path for CSV with results.
```

The csv's have the following format: `id,sentence,labels`
The `id` field shows what data generation steps have been involved for that sentence, for example:
* `1559`: the original sentence
* `1559-pegasus-1`: first new sentence generated by pegasus for the original `1559` sentence
* `1559-invert`: inverted original sentence
* `1559-invert-pegasus-4`: eight new sentence generated by pegasus for `1559-invert`
* `1-word`: newly generated sentence by filling in a template with new words
* `1-word-pegasus-4`: fourth pegasus generated sentence for newly generated template
* ... and so on

These separate csv's can be combined with the `combine_datasets.py` script, this script also filters out duplicate sentences.


## Pegasus English paraphrase
```
usage: generate_pegasus_data.py [-h] [-i INPUT_PATH] [-o OUTPUT_PATH] [-m MAX_NEW] [-tl]

optional arguments:
  -h, --help            show this help message and exit
  -i INPUT_PATH, --input_path INPUT_PATH
                        English CSV with templates to expand.
  -o OUTPUT_PATH, --output_path OUTPUT_PATH
                        Output path for CSV with results.
  -m MAX_NEW, --max_new MAX_NEW
                        Max new sentences to generate per sentence
  -tl, --total_len      Use the overall min and max sentence lengths of the entire corpus, instead of individual sentences
```

## Inverting sentences and labels
```
usage: invert.py [-h] [-l LANGUAGES [LANGUAGES ...]]

optional arguments:
  -h, --help            show this help message and exit
  -l LANGUAGES [LANGUAGES ...], --languages LANGUAGES [LANGUAGES ...]
                        Language datasets to use for the inverting of the
                        labels
```

# Data experiments
## Separate methods
- Original training data
- Inverted training data
- Manual templates with words from training data
- Pegasus added training data
- Manual templates + new words
- Manual templates + new words + lemmatize all
- Manual templates + new words + lemmatize nouns
- Manual templates + hypo of hypo

## Combined methods
- Possibly use a single English model and translate the Italian and French test data to English to use that model for inference
- Manual templates -> hypo of hypo -> inverted
- Manual templates -> hypo of hypo -> inverted -> pegasus
